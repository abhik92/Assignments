//
// Generated by JTB 1.3.2
//

package visitor;

import syntaxtree.*;

import java.util.*;
import java.util.Map.Entry;
import java.util.logging.Logger;

import MainPackage.FunctionClass;
import MainPackage.SymbolTable;
import MainPackage.VariableClass;
import MainPackage.Class;

/**
 * Provides default methods which visit each node in the tree in depth-first
 * order. Your visitors may extend this class.
 */
public class GJNoArguDepthFirst_Parse2<R> implements GJNoArguVisitor<R> {
	/* Set of helper variables and functions */
	public SymbolTable symt;
	public int k = -1;
	public Vector<ArrayList<String>> paraStack = new Vector<ArrayList<String>>();

	public static HashMap<Integer, Object> tempTable = new HashMap<Integer, Object>();

	public GJNoArguDepthFirst_Parse2(SymbolTable sym) {
		this.symt = sym;
		SymbolTable.currentClass = null;
		SymbolTable.currentFunction = null;
	}

	public ArrayList<FunctionClass> getFunctions(String className) {
		ArrayList<FunctionClass> funcs = new ArrayList<FunctionClass>();
		Set<Entry<String, Object>> allElements = SymbolTable.mainTable
				.entrySet();
		for (Entry<String, Object> s : allElements) {
			String key = s.getKey();
			String values[] = key.split("\\s+");
			if (values[2].equals(className)) {
				Object o = s.getValue();
				if (o instanceof FunctionClass)
					funcs.add((FunctionClass) o);

			}
		}
		return funcs;
	}

	public ArrayList<VariableClass> getVariables(String className) {
		ArrayList<VariableClass> vars = new ArrayList<VariableClass>();
		Set<Entry<String, Object>> allElements = SymbolTable.mainTable
				.entrySet();
		for (Entry<String, Object> s : allElements) {
			String key = s.getKey();
			String values[] = key.split("\\s+");
			if (values[2].equals(className) && values[3] == null) {
				Object o = s.getValue();
				if (o instanceof VariableClass)
					vars.add((VariableClass) o);

			}
		}
		return vars;
	}

	public R IType(R var) {
		if (var == "int" || var == "int[]" || var == "boolean") {
			return var;

		} else {
			String hashString = symt.hashString("variable", (String) var,
					SymbolTable.currentClass, SymbolTable.currentFunction);

			VariableClass V;
			if (SymbolTable.mainTable.containsKey(hashString)) {
				V = (VariableClass) symt.query(hashString);
				return (R) V.type;
			}

			hashString = symt.hashString("variable", (String) var,
					SymbolTable.currentClass, null);

			if (SymbolTable.mainTable.containsKey(hashString)) {
				V = (VariableClass) symt.query(hashString);
				return (R) V.type;
			}

			hashString = symt.hashString("function", (String) var,
					SymbolTable.currentClass, SymbolTable.currentFunction);

			FunctionClass F;
			if (SymbolTable.mainTable.containsKey(hashString)) {
				F = (FunctionClass) symt.query(hashString);
				return (R) F.retType;
			}

			hashString = symt.hashString("class", (String) ClassName(var),
					(String) ClassName(var), null);

			Class C;
			if (SymbolTable.mainTable.containsKey(hashString)) {
				C = (Class) symt.query(hashString);
				return (R) C.name;
			}
		}

		return null;
	}

	public R ClassName(R var) {

		String currentClass = SymbolTable.currentClass;
		ArrayList<String> listOfAlias = new ArrayList<String>();

		listOfAlias = SymbolTable.Alias.get(currentClass);

		String hashString = symt.hashString("variable", (String) var,
				SymbolTable.currentClass, SymbolTable.currentFunction);
		VariableClass V;
		if (SymbolTable.mainTable.containsKey(hashString)) {
			V = (VariableClass) symt.query(hashString);
			return (R) V.type;
		}

		hashString = symt.hashString("variable", (String) var,
				SymbolTable.currentClass, null);
		if (SymbolTable.mainTable.containsKey(hashString)) {
			V = (VariableClass) symt.query(hashString);

			return (R) V.type;
		}

		return var;
	}

	public R visit(NodeList n) {
		R _ret = null;
		int _count = 0;
		for (Enumeration<Node> e = n.elements(); e.hasMoreElements();) {
			e.nextElement().accept(this);
			_count++;
		}
		return _ret;
	}

	public R visit(NodeListOptional n) {
		if (n.present()) {
			R _ret = null;
			int _count = 0;
			for (Enumeration<Node> e = n.elements(); e.hasMoreElements();) {
				e.nextElement().accept(this);
				_count++;
			}
			return _ret;
		} else
			return null;
	}

	public R visit(NodeOptional n) {
		if (n.present())
			return n.node.accept(this);
		else
			return null;
	}

	public R visit(NodeSequence n) {
		R _ret = null;
		int _count = 0;
		for (Enumeration<Node> e = n.elements(); e.hasMoreElements();) {
			e.nextElement().accept(this);
			_count++;
		}
		return _ret;
	}

	public R visit(NodeToken n) {
		return null;
	}

	//
	// User-generated visitor methods below
	//

	/**
	 * f0 -> MainClass() f1 -> ( TypeDeclaration() )* f2 -> <EOF>
	 */
	public R visit(Goal n) {
		R _ret = null;
		n.f0.accept(this);
		n.f1.accept(this);
		n.f2.accept(this);
		return _ret;
	}

	/**
	 * f0 -> "class" f1 -> Identifier() f2 -> "{" f3 -> "public" f4 -> "static"
	 * f5 -> "void" f6 -> "main" f7 -> "(" f8 -> "String" f9 -> "[" f10 -> "]"
	 * f11 -> Identifier() f12 -> ")" f13 -> "{" f14 -> PrintStatement() f15 ->
	 * "}" f16 -> "}"
	 */
	public R visit(MainClass n) {
		R _ret = null;
		n.f0.accept(this);
		n.f1.accept(this);
		n.f2.accept(this);
		n.f3.accept(this);
		n.f4.accept(this);
		n.f5.accept(this);
		// System.out.println("MAIN");
		n.f6.accept(this);
		n.f7.accept(this);
		n.f8.accept(this);
		n.f9.accept(this);
		n.f10.accept(this);
		n.f11.accept(this);
		n.f12.accept(this);
		n.f13.accept(this);
		n.f14.accept(this);
		n.f15.accept(this);
		n.f16.accept(this);
		// System.out.println("END");
		return _ret;
	}

	/**
	 * f0 -> ClassDeclaration() | ClassExtendsDeclaration()
	 */
	public R visit(TypeDeclaration n) {
		R _ret = null;
		if (n.f0.which == 0) {
			String name = ((ClassDeclaration) n.f0.choice).f1.f0.tokenImage;
			SymbolTable.currentClass = name;

			ArrayList<Object> varTable = new ArrayList<Object>();
			ArrayList<FunctionClass> funcTable = new ArrayList<FunctionClass>();

			ArrayList<FunctionClass> func = this.getFunctions(name);
			ArrayList<VariableClass> vars = this.getVariables(name);

			funcTable.addAll(func);
			tempTable.put(21, funcTable);

			varTable.add("TEMP " + 21);
			varTable.addAll(vars);

			tempTable.put(0, varTable);
			
			System.out.println("HELLO" + tempTable.size());

		}
		if (n.f0.which == 1) {
			String name = ((ClassExtendsDeclaration) n.f0.choice).f1.f0.tokenImage;
			SymbolTable.currentClass = name;

			ArrayList<Object> varTable = new ArrayList<Object>();
			ArrayList<FunctionClass> funcTable = new ArrayList<FunctionClass>();

			ArrayList<FunctionClass> func = this.getFunctions(name);
			ArrayList<VariableClass> vars = this.getVariables(name);

			funcTable.addAll(func);
			tempTable.put(21, funcTable);

			varTable.add("TEMP " + 21);
			varTable.addAll(vars);

			tempTable.put(0, varTable);
			
			
			
		}
		SymbolTable.currentFunction = null;
		n.f0.accept(this);
		return _ret;
	}

	/**
	 * f0 -> "class" f1 -> Identifier() f2 -> "{" f3 -> ( VarDeclaration() )* f4
	 * -> ( MethodDeclaration() )* f5 -> "}"
	 */
	public R visit(ClassDeclaration n) {
		R _ret = null;
		n.f0.accept(this);
		n.f1.accept(this);
		n.f2.accept(this);
		n.f3.accept(this);
		n.f4.accept(this);
		n.f5.accept(this);
		return _ret;
	}

	/**
	 * f0 -> "class" f1 -> Identifier() f2 -> "extends" f3 -> Identifier() f4 ->
	 * "{" f5 -> ( VarDeclaration() )* f6 -> ( MethodDeclaration() )* f7 -> "}"
	 */
	public R visit(ClassExtendsDeclaration n) {
		R _ret = null;
		n.f0.accept(this);
		n.f1.accept(this);
		n.f2.accept(this);
		n.f3.accept(this);
		n.f4.accept(this);
		n.f5.accept(this);
		n.f6.accept(this);
		n.f7.accept(this);
		return _ret;
	}

	/**
	 * f0 -> Type() f1 -> Identifier() f2 -> ";"
	 */
	public R visit(VarDeclaration n) {
		R _ret = null;
		n.f0.accept(this);
		n.f1.accept(this);
		n.f2.accept(this);
		return _ret;
	}

	/**
	 * f0 -> "public" f1 -> Type() f2 -> Identifier() f3 -> "(" f4 -> (
	 * FormalParameterList() )? f5 -> ")" f6 -> "{" f7 -> ( VarDeclaration() )*
	 * f8 -> ( Statement() )* f9 -> "return" f10 -> Expression() f11 -> ";" f12
	 * -> "}"
	 */
	public R visit(MethodDeclaration n) {
		R _ret = null;

		String name = n.f2.f0.tokenImage;
		SymbolTable.currentFunction = name;

		n.f0.accept(this);
		R ret1 = n.f1.accept(this);
		R methodName = n.f2.accept(this);
		// System.out.print(SymbolTable.currentClass + "_" + (String) methodName
		// + " [ ");
		String hashString = symt.hashString("function", (String) methodName,
				SymbolTable.currentClass, (String) methodName);
		FunctionClass F = (FunctionClass) symt.query(hashString);
		int numberOfParams = F.formalParamList.size();
		// System.out.println(numberOfParams + 1 + " ] ");
		// System.out.println("BEGIN");
		n.f3.accept(this);
		n.f4.accept(this);
		n.f5.accept(this);
		n.f6.accept(this);
		n.f7.accept(this);
		n.f8.accept(this);
		n.f9.accept(this);
		R ret2 = n.f10.accept(this);
		n.f11.accept(this);
		n.f12.accept(this);

		// System.out.println("END");

		return _ret;
	}

	/**
	 * f0 -> FormalParameter() f1 -> ( FormalParameterRest() )*
	 */
	public R visit(FormalParameterList n) {
		R _ret = null;
		n.f0.accept(this);
		n.f1.accept(this);
		return _ret;
	}

	/**
	 * f0 -> Type() f1 -> Identifier()
	 */
	public R visit(FormalParameter n) {
		R _ret = null;
		n.f0.accept(this);
		n.f1.accept(this);

		return _ret;
	}

	/**
	 * f0 -> "," f1 -> FormalParameter()
	 */
	public R visit(FormalParameterRest n) {
		R _ret = null;
		n.f0.accept(this);
		n.f1.accept(this);
		return _ret;
	}

	/**
	 * f0 -> ArrayType() | BooleanType() | IntegerType() | Identifier()
	 */
	public R visit(Type n) {
		R _ret = null;
		n.f0.accept(this);
		if (n.f0.which == 0)
			_ret = (R) "int[]";
		if (n.f0.which == 1)
			_ret = (R) "boolean";
		if (n.f0.which == 2)
			_ret = (R) "int";
		if (n.f0.which == 3)
			_ret = (R) ((Identifier) (n.f0.choice)).f0.tokenImage;
		return _ret;
	}

	/**
	 * f0 -> "int" f1 -> "[" f2 -> "]"
	 */
	public R visit(ArrayType n) {
		R _ret = null;
		n.f0.accept(this);
		n.f1.accept(this);
		n.f2.accept(this);
		return _ret;
	}

	/**
	 * f0 -> "boolean"
	 */
	public R visit(BooleanType n) {
		R _ret = null;
		n.f0.accept(this);
		return _ret;
	}

	/**
	 * f0 -> "int"
	 */
	public R visit(IntegerType n) {
		R _ret = null;
		n.f0.accept(this);
		return _ret;
	}

	/**
	 * f0 -> Block() | AssignmentStatement() | ArrayAssignmentStatement() |
	 * IfStatement() | WhileStatement() | PrintStatement()
	 */
	public R visit(Statement n) {
		R _ret = null;
		n.f0.accept(this);
		return _ret;
	}

	/**
	 * f0 -> "{" f1 -> ( Statement() )* f2 -> "}"
	 */
	public R visit(Block n) {
		R _ret = null;
		n.f0.accept(this);
		n.f1.accept(this);
		n.f2.accept(this);
		return _ret;
	}

	/**
	 * f0 -> Identifier() f1 -> "=" f2 -> Expression() f3 -> ";"
	 */
	public R visit(AssignmentStatement n) {
		R _ret = null;
		R ret1 = n.f0.accept(this);
		n.f1.accept(this);
		R ret2 = n.f2.accept(this);
		n.f3.accept(this);
		String variableName = (String) ret1;
		VariableClass V = (VariableClass) symt.query(symt.hashString(
				"variable", variableName, SymbolTable.currentClass,
				SymbolTable.currentFunction));
		// System.out.println("MOVE " + "TEMP " + V.tempNumber + " "
		// + (String) ret2);

		return _ret;
	}

	/**
	 * f0 -> Identifier() f1 -> "[" f2 -> Expression() f3 -> "]" f4 -> "=" f5 ->
	 * Expression() f6 -> ";"
	 */
	public R visit(ArrayAssignmentStatement n) {
		R _ret = null;
		R identifier = n.f0.accept(this);
		R expression1 = n.f1.accept(this);
		n.f2.accept(this);
		n.f3.accept(this);
		n.f4.accept(this);
		R expression2 = n.f5.accept(this);
		n.f6.accept(this);

		String variableName = (String) identifier;
		VariableClass V = (VariableClass) symt.query(symt.hashString(
				"variable", variableName, SymbolTable.currentClass,
				SymbolTable.currentFunction));
		// System.out.println("HSTORE " + "TEMP " + V.tempNumber + " "
		// + (Integer) expression1 * 4 + " " + (String) expression2);

		return _ret;
	}

	/**
	 * f0 -> "if" f1 -> "(" f2 -> Expression() f3 -> ")" f4 -> Statement() f5 ->
	 * "else" f6 -> Statement()
	 */
	public R visit(IfStatement n) {
		R _ret = null;
		n.f0.accept(this);
		n.f1.accept(this);
		n.f2.accept(this);
		n.f3.accept(this);
		n.f4.accept(this);
		n.f5.accept(this);
		n.f6.accept(this);
		return _ret;
	}

	/**
	 * f0 -> "while" f1 -> "(" f2 -> Expression() f3 -> ")" f4 -> Statement()
	 */
	public R visit(WhileStatement n) {
		R _ret = null;
		n.f0.accept(this);
		n.f1.accept(this);
		n.f2.accept(this);
		n.f3.accept(this);
		n.f4.accept(this);
		return _ret;
	}

	/**
	 * f0 -> "System.out.println" f1 -> "(" f2 -> Expression() f3 -> ")" f4 ->
	 * ";"
	 */
	public R visit(PrintStatement n) {
		R _ret = null;
		n.f0.accept(this);
		// System.out.println("PRINT");
		n.f1.accept(this);
		n.f2.accept(this);
		n.f3.accept(this);
		n.f4.accept(this);
		return _ret;
	}

	/**
	 * f0 -> AndExpression() | CompareExpression() | PlusExpression() |
	 * MinusExpression() | TimesExpression() | ArrayLookup() | ArrayLength() |
	 * MessageSend() | PrimaryExpression()
	 */
	public R visit(Expression n) {
		R _ret = null;
		_ret = n.f0.accept(this);

		return _ret;
	}

	/**
	 * f0 -> PrimaryExpression() f1 -> "&" f2 -> PrimaryExpression()
	 */

	public R visit(AndExpression n) {
		R ret1 = n.f0.accept(this);
		n.f1.accept(this);
		R ret2 = n.f2.accept(this);

		return IType(ret1);
	}

/**
    * f0 -> PrimaryExpression()
    * f1 -> "<"
    * f2 -> PrimaryExpression()
    */
	public R visit(CompareExpression n) {

		R ret1 = n.f0.accept(this);
		n.f1.accept(this);
		R ret2 = n.f2.accept(this);

		return (R) "boolean";
	}

	/**
	 * f0 -> PrimaryExpression() f1 -> "+" f2 -> PrimaryExpression()
	 */
	public R visit(PlusExpression n) {
		R ret1 = n.f0.accept(this);
		n.f1.accept(this);
		R ret2 = n.f2.accept(this);

		return (R) "int";
	}

	/**
	 * f0 -> PrimaryExpression() f1 -> "-" f2 -> PrimaryExpression()
	 */
	public R visit(MinusExpression n) {
		R ret1 = n.f0.accept(this);
		n.f1.accept(this);
		R ret2 = n.f2.accept(this);

		return (R) "int";
	}

	/**
	 * f0 -> PrimaryExpression() f1 -> "*" f2 -> PrimaryExpression()
	 */
	public R visit(TimesExpression n) {
		R ret1 = n.f0.accept(this);
		n.f1.accept(this);
		R ret2 = n.f2.accept(this);

		return (R) "int";
	}

	/**
	 * f0 -> PrimaryExpression() f1 -> "[" f2 -> PrimaryExpression() f3 -> "]"
	 */
	public R visit(ArrayLookup n) {
		R ret1 = n.f0.accept(this);
		n.f1.accept(this);
		R ret2 = n.f2.accept(this);
		n.f3.accept(this);

		return (R) "int";
	}

	/**
	 * f0 -> PrimaryExpression() f1 -> "." f2 -> "length"
	 */
	public R visit(ArrayLength n) {
		R _ret = null;
		_ret = n.f0.accept(this);
		n.f1.accept(this);
		n.f2.accept(this);

		return (R) "int";
	}

	/**
	 * f0 -> PrimaryExpression() f1 -> "." f2 -> Identifier() f3 -> "(" f4 -> (
	 * ExpressionList() )? f5 -> ")"
	 */
	public R visit(MessageSend n) {
		String var = " CALL ";

		R primExp = n.f0.accept(this);

		n.f1.accept(this);

		R iden = n.f2.accept(this);
		n.f3.accept(this);
		n.f4.accept(this);
		n.f5.accept(this);

		return (R) var;
	}

	/**
	 * f0 -> Expression() f1 -> ( ExpressionRest() )*
	 */
	public R visit(ExpressionList n) {
		R _ret = null;
		R ret1 = n.f0.accept(this);
		n.f1.accept(this);
		return _ret;
	}

	/**
	 * f0 -> "," f1 -> Expression()
	 */
	public R visit(ExpressionRest n) {
		R _ret = null;
		n.f0.accept(this);
		R ret1 = n.f1.accept(this);

		return _ret;
	}

	/**
	 * f0 -> IntegerLiteral() | TrueLiteral() | FalseLiteral() | Identifier() |
	 * ThisExpression() | ArrayAllocationExpression() | AllocationExpression() |
	 * NotExpression() | BracketExpression()
	 */
	public R visit(PrimaryExpression n) {
		R _ret = null;
		_ret = (R) n.f0.accept(this);

		return _ret;
	}

	/**
	 * f0 -> <INTEGER_LITERAL>
	 */
	public R visit(IntegerLiteral n) {
		n.f0.accept(this);
		return (R) (" " + n.f0.tokenImage + " ");
	}

	/**
	 * f0 -> "true"
	 */
	public R visit(TrueLiteral n) {
		n.f0.accept(this);
		return (R) " 1 ";
	}

	/**
	 * f0 -> "false"
	 */
	public R visit(FalseLiteral n) {
		n.f0.accept(this);
		return (R) " 0 ";
	}

	/**
	 * f0 -> <IDENTIFIER>
	 */
	public R visit(Identifier n) {
		n.f0.accept(this);
		String identifier = n.f0.tokenImage;
		return (R) identifier;
	}

	/**
	 * f0 -> "this"
	 */

	public R visit(ThisExpression n) {
		n.f0.accept(this);
		String var = " TEMP 0 ";
		return (R) var;
	}

	/**
	 * f0 -> "new" f1 -> "int" f2 -> "[" f3 -> Expression() f4 -> "]"
	 */
	public R visit(ArrayAllocationExpression n) {
		R _ret = null;
		n.f0.accept(this);
		n.f1.accept(this);
		n.f2.accept(this);
		_ret = n.f3.accept(this);
		int currentMax = SymbolTable.maxTempNumber;
		SymbolTable.maxTempNumber++;
		String var = " BEGIN ";

		String exp = (String) _ret;
		String hashString = symt.hashString("variable", exp,
				SymbolTable.currentClass, SymbolTable.currentFunction);

		if (SymbolTable.mainTable.containsKey(hashString)) {
			VariableClass V = (VariableClass) symt.query(hashString);
			exp = " TEMP " + V.tempNumber;

		}
		hashString = symt.hashString("variable", exp, SymbolTable.currentClass,
				null);

		if (SymbolTable.mainTable.containsKey(hashString)) {
			ArrayList<Object> VariableTable = (ArrayList<Object>) tempTable
					.get(0);
			System.out.println("OK" + VariableTable.size());
			int offset = 4;
			for (Object o : VariableTable) {
				if (o instanceof String)
					continue;
				VariableClass objToVar = (VariableClass) o;
				if (objToVar.name.equals(exp)) {
					System.out.println("HI" + objToVar.name);
					break;
				}
				offset += 4;
			}
			var = var + " HLOAD TEMP " + SymbolTable.maxTempNumber + " TEMP 0 "
					+ offset;
			exp = " TEMP " + SymbolTable.maxTempNumber;
			SymbolTable.maxTempNumber++;
		}
		var = var + " MOVE TEMP " + currentMax + " ";
		var = var + " HALLOCATE TIMES PLUS " + exp + " 1 4 ";

		var = var + " RETURN " + " TEMP " + currentMax;
		var = var + " END ";
		System.out.println(var);
		n.f4.accept(this);
		return (R) var;
	}

	/**
	 * f0 -> "new" f1 -> Identifier() f2 -> "(" f3 -> ")"
	 */

	public R visit(AllocationExpression n) {
		R _ret = null;
		n.f0.accept(this);
		_ret = n.f1.accept(this);

		// Begin printed
		String var = "BEGIN \n";

		ArrayList<Object> varTable = new ArrayList<Object>();
		ArrayList<FunctionClass> funcTable = new ArrayList<FunctionClass>();

		ArrayList<FunctionClass> func = this.getFunctions((String) _ret);
		ArrayList<VariableClass> vars = this.getVariables((String) _ret);

		funcTable.addAll(func);
		tempTable.put(SymbolTable.maxTempNumber, funcTable);

		// Allocating space for function table
		var = var + " MOVE TEMP " + SymbolTable.maxTempNumber + " HALLOCATE "
				+ func.size() * 4;

		varTable.add("TEMP " + SymbolTable.maxTempNumber);

		varTable.addAll(vars);
		SymbolTable.maxTempNumber++;

		tempTable.put(SymbolTable.maxTempNumber, varTable);

		// Allocating space for Variable table
		var = var + "\n MOVE TEMP " + SymbolTable.maxTempNumber + " HALLOCATE "
				+ (vars.size() + 1) * 4;
		SymbolTable.maxTempNumber++;

		int count = 0;
		// Store all the function values in the corresponding offset
		for (FunctionClass f : func) {
			var = var + " HSTORE TEMP " + (SymbolTable.maxTempNumber - 2) + " "
					+ count + " " + (String) _ret + "_" + f.name;
			count = count + 4;
		}

		// Point the first of variable table list to function table list
		var = var + " HSTORE TEMP " + (SymbolTable.maxTempNumber - 1) + " 0 "
				+ "TEMP " + (SymbolTable.maxTempNumber - 2);
		count = 4;

		// Store all the variables in the variable table list
		for (VariableClass V : vars) {
			var = var + " HSTORE TEMP " + (SymbolTable.maxTempNumber - 1) + " "
					+ count + " 0 ";
			count = count + 4;
		}

		var = var + " RETURN TEMP " + (SymbolTable.maxTempNumber - 1);
		var = var + " END ";
		// System.out.println(var);
		n.f2.accept(this);
		n.f3.accept(this);
		return (R) var;
	}

	/**
	 * f0 -> "!" f1 -> Expression()
	 */
	public R visit(NotExpression n) {

		n.f0.accept(this);
		R ret = n.f1.accept(this);
		String str = " MINUS 1 " + (String) ret + " ";
		return (R) (str);
	}

	/**
	 * f0 -> "(" f1 -> Expression() f2 -> ")"
	 */
	public R visit(BracketExpression n) {
		R _ret = null;
		n.f0.accept(this);
		_ret = (R) n.f1.accept(this);
		n.f2.accept(this);

		return _ret;
	}

}
